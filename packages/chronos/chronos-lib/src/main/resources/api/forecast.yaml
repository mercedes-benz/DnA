# LICENSE START
#
# MIT License
#
# Copyright (c) 2019 Daimler TSS GmbH
#
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the "Software"), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:
#
# The above copyright notice and this permission notice shall be included in all
# copies or substantial portions of the Software.
#
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
# SOFTWARE.
#
# LICENSE END
#
#-----------------------------------------------------------------------------------------------------
#  **
#  ** File Name  : forecast.yaml
#  **
#  ** Module     : core
#  **

#  -------------------------------------------------------------------------------------------------------
#
#  CHANGE HISTORY
#
#  Created By         :  BEALURI
#
#  Bug Number         :
#  Changed By         :
#  Change Description :
#  Change On          :
#  Search String      :
#
#  -------------------------------------------------------------------------------------------------------


swagger: "2.0"
info:
  version: "1.0.0"
  title: "Chronos Workspace Service"
host: "localhost:8989"
basePath: "/api/1.0"
consumes:
  - "application/json"
produces:
  - "application/json"
tags:
  - name: "forecasts"
    description: "This service is used to maintain forecasts information."

schemes:
  - "https"

paths:
  
  # Fetch all valid userinfo or by intent
  #
  #  supported http methods GET, POST, PUT
  #
  # path example ../forecasts
  
  /forecasts:
    get:
      tags:
        - "forecast-projects"
      summary: "Get all forecast projects for the user."
      description:  "Get all forecasts projects for the user."
      operationId: "getAll"
      parameters:
        - name: offset
          in: query
          description: page number from which listing of forecasts should start. Offset. Example 2
          required: false
          type: integer
        - name: limit
          in: query
          description: page size to limit the number of forecasts, Example 15
          required: false
          type: integer
      responses:
        201:
          description: "Returns message of success or failure"
          schema:
            $ref: "#/definitions/ForecastCollectionVO"
        204:
          description: "Fetch complete, no content found."
        400:
          description: "Bad request."
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
    
    post:
      tags:
        - "forecast-projects"
      summary: "Initialize/Create forecast project for user."
      description: "Create forecast project for user "
      operationId: "createForecastProject"
      parameters:
        - name: "forecastRequestVO"
          in: "body"
          description: "Request Body that contains data required for intialize chronos project for user"
          required: true
          schema:
            $ref: "#/definitions/ForecastProjectCreateRequestWrapperVO"
      responses:
        201:
          description: "Returns message of success or failure "
          schema:
            $ref: "#/definitions/ForecastProjectResponseVO"
        400:
          description: "Bad Request"
          schema:
            $ref: "#/definitions/GenericMessage"
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
    
    #    put:
    #      tags:
    #        - "forecast-projects"
    #      summary: "Update/manage forecast project for user."
    #      description: "Update forecast project for user "
    #      operationId: "updateForecastProject"
    #      parameters:
    #        - name: "forecastUpdateRequestVO"
    #          in: "body"
    #          description: "Request Body that contains data required for intialize chronos project for user"
    #          required: true
    #          schema:
    #            $ref: "#/definitions/ForecastProjectUpdateRequestVO"
    #      responses:
    #        201:
    #          description: "Returns message of success or failure "
    #          schema:
    #            $ref: "#/definitions/ForecastProjectResponseVO"
    #        400:
    #          description: "Bad Request"
    #          schema:
    #            $ref: "#/definitions/GenericMessage"
    #        401:
    #          description: "Request does not have sufficient credentials."
    #        403:
    #          description: "Request is not authorized."
    #        405:
    #          description: "Method not allowed"
    #        500:
    #          description: "Internal error"
  
  /forecasts/default-config/files:
    get:
      tags:
        - "forecast-projects"
      summary: "Get forecasts config files"
      description: "Get forecasts config files"
      operationId: "getConfigFiles"
      parameters:
        - name: "id"
          in: query
          description: "forecast project ID "
          required: false
          type: "string"
      responses:
        200:
          description: "Returns message of success or failure"
          schema:
            $ref: "#/definitions/BucketObjectsCollectionWrapperDto"
        204:
          description: "Fetch complete, no content found."
        400:
          description: "Bad request."
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
  
  # Fetch all valid userinfo or by intent
  #
  #  supported http methods GET, POST and DELETE
  #
  # path example ../forecasts/{id}
  
  /forecasts/{id}:
    get:
      tags:
        - "forecast-projects"
      summary: "Get forecasts details for a given Id."
      description: "Get forecasts details for a given Id."
      operationId: "getById"
      parameters:
        - name: "id"
          in: "path"
          description: "forecast project ID to be fetched"
          required: true
          type: "string"
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      responses:
        200:
          description: "Returns message of success or failure"
          schema:
            $ref: "#/definitions/ForecastVO"
        204:
          description: "Fetch complete, no content found."
        400:
          description: "Bad request."
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
    put:
      tags:
        - "forecast-projects"
      summary: "update forecasts details for a given Id."
      description: "update forecasts details for a given Id."
      operationId: "updateById"
      parameters:
        - name: "id"
          in: "path"
          description: "forecast project ID to be updated"
          required: true
          type: "string"
        - name: "forecastUpdateRequestVO"
          in: "body"
          description: "Request Body that contains data required for updating of collab details"
          required: true
          schema:
            $ref: "#/definitions/ForecastProjectUpdateRequestVO"
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      responses:
        200:
          description: "Returns message of success or failure"
          schema:
            $ref: "#/definitions/ForecastProjectResponseVO"
        204:
          description: "Fetch complete, no content found."
        400:
          description: "Bad request."
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
    delete:
      tags:
        - "forecast-projects"
      summary: "delete forecasts details for a given Id."
      description: "delete forecasts details for a given Id."
      operationId: "deleteById"
      parameters:
        - name: "id"
          in: "path"
          description: "forecast project ID to be delete"
          required: true
          type: "string"
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      responses:
        200:
          description: "Returns message of success"
          schema:
            $ref: "#/definitions/GenericMessage"
        400:
          description: "Bad request."
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
  
  /forecasts/{id}/apikey:
    post:
      tags:
        - "forecast-projects"
      summary: "API Key Generation for Forecast project."
      description: "API Key Generation."
      operationId: "generateApikey"
      parameters:
        - in: "path"
          name: "id"
          description: "forecast project ID"
          required: true
          type: "string"
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      responses:
        201:
          description: "Returns message of success or failure "
          schema:
            $ref: "#/definitions/ApiKeyResponseVO"
        400:
          description: "Bad Request"
          schema:
            $ref: "#/definitions/GenericMessage"
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
    get:
      tags:
        - "forecast-projects"
      summary: "API Key Generation for Forecast project."
      description: "API Key Generation."
      operationId: "getApikey"
      parameters:
        - in: "path"
          name: "id"
          description: "forecast project ID"
          required: true
          type: "string"
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      responses:
        201:
          description: "Returns message of success or failure "
          schema:
            $ref: "#/definitions/ApiKeyResponseVO"
        400:
          description: "Bad Request"
          schema:
            $ref: "#/definitions/GenericMessage"
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
  
  #
  #  supported http methods GET
  #
  # path example ../forecasts/{id}/inputs
  
  
  /forecasts/{id}/inputs:
    get:
      tags:
        - "forecast-inputs"
      summary: "Get list of saved input files"
      description: "Get list of saved input files"
      operationId: "getInputFiles"
      parameters:
        - name: "id"
          in: "path"
          description: "forecast project ID "
          required: true
          type: "string"
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      responses:
        201:
          description: "Returns message of success or failure"
          schema:
            $ref: "#/definitions/InputFilesCollectionVO"
        204:
          description: "Fetch complete, no content found."
        400:
          description: "Bad request."
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
  
  /forecasts/{id}/inputs/{savedinputid}:
    delete:
      tags:
        - "forecast-inputs"
      summary: "delete uploaded input file."
      description: "delete uploaded input file by id."
      operationId: "deleteSavedInputFile"
      parameters:
        - name: "id"
          in: "path"
          description: "forecast project ID "
          required: true
          type: "string"
        - name: "savedinputid"
          in: "path"
          description: "saved Input file ID"
          required: true
          type: "string"
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      
      responses:
        201:
          description: "Returns message of success or failure"
          schema:
            $ref: "#/definitions/GenericMessage"
        204:
          description: "Fetch complete, no content found."
        400:
          description: "Bad request."
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
  
  
  
  
  #
  #  supported http methods GET
  #
  # path example ../forecasts/{id}/runs
  
  /forecasts/{id}/runs:
    get:
      tags:
        - "forecast-runs"
      summary: "Get all runs for the selected project."
      description:  |
        This will return details of all runs for the selected project. Make
        sure to filter the results by status if you only want to see finished
        runs. You can also use this to check status of a run.
      operationId: "getAllRunsForProject"
      parameters:
        - in: "path"
          name: "id"
          description: "forecast project ID "
          required: true
          type: "string"
        - name: offset
          in: query
          description: page number from which listing of forecasts should start. Offset. Example 2
          required: false
          type: integer
        - name: limit
          in: query
          description: page size to limit the number of forecasts, Example 15
          required: false
          type: integer
        - name: sortBy
          in: query
          description: Sort runs by a given variable like name, createdby, createdon, or status
          required: false
          type: string
          enum: [ runName,createdOn,status,createdBy,inputFile ]
        - name: sortOrder
          in: query
          description: "Sort runs based on the given order, example: asc, desc"
          required: false
          type: string
          enum: [ asc,desc ]
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      responses:
        201:
          description: "Returns message of success or failure"
          schema:
            $ref: "#/definitions/ForecastRunCollectionVO"
        204:
          description: "Fetch complete, no content found."
        400:
          description: "Bad request."
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
    
    post:
      tags:
        - "forecast-runs"
      summary: "Start a new run for the forecast project."
      description: |
        This is the command to start a new Chronos forecast run in an already
        existing project. The run will be started asynchronously and the
        response will contain the correlation ID of the run. This correlation
        ID can be used to query the status of the run via the `GET
        /api/forecasts/{id}/runs` endpoint.

        For more information on how to use this endpoint, please refer to the
        Chronos Documentation.
      operationId: "createForecastRun"
      consumes:
        - multipart/form-data
      parameters:
        - in: "path"
          name: "id"
          description: |
            Project ID (UUID) of the project for which the run should be
            started. You can find this ID as `Api Id` in the project details
            page in the Chronos UI Application. You will also find it in the
            URL if you open your project in the browser.
          required: true
          type: "string"
        - in: formData
          name: file
          type: file
          description: |
            The Chronos Input file (*.xlsx or *.csv) containing the data to be
            forecast. To learn more about the input file format, please refer
            to the Chronos Documentation.

            If you do not set this, you need to instead provide the path to a
            file in your MinIO storage bucket via the `savedInputPath`.
          required: false
        - in: formData
          name: savedInputPath
          type: string
          description: |
            Normally, you probably don't want to use this setting.

            If you want to provide a file you have already stored in MinIO, you
            can provide the path to the file here. 
          required: false
        - in: formData
          name: saveRequestPart
          type: boolean
          description: |
            Set this to true if you want to store the provided input file for
            future runs. Only set this to true if you later on want to do a
            forecast with the exact same file, but a different configuration.
            Files saved this way can be re-used via the `savedInputPath` field.
          required: false
        - in: formData
          name: runName
          type: string
          description: |
            A name for the run. This name will be displayed in the Chronos UI
            Application. If you do not provide a name, the run name will be set
            to the current date and time.
          required: false
        - in: formData
          name: configurationFile
          type: string
          description: |
            The Chronos configuration file you want to use.

            The default configuration file resides under
            `chronos-core/configs/default_config.yml`, this is what you need to
            provide here to use the default configuration.

            If you want to use a custom configuration file, you need to upload
            it first (easiest done via the Chronos UI Application) and then
            provide the path to the file here. The file path will be
            `chronos-<project_name>/configs/<config_filename.yml>`, where
            project_name is the actual name of your project (not the UUID)
          required: true
        - in: formData
          name: frequency
          type: string
          enum: [Daily,Weekly,Monthly,Yearly,No_Frequency]
          description: |
            The frequency of your data.

            You can find a list of all supported frequencies here:
            `https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases`

            Note that Chronos is mostly tested on monthly data, so you should
            carefully evaluate forecast quality when using other frequencies.
          required: true
        - in: formData
          name: forecastHorizon
          type: number
          minimum: 1
          description: |
            Number of time steps to forecast. Must be 1 or larger.
          required: true
        - in: formData
          name: hierarchy
          type: string
          description: |
            Set this parameter only if your data is hierarchical. 
            
            Set to the number of hierarchy levels in your data. This is equal
            to the number of rows containing headers. To learn more about
            hierarchical forecasting, search for *hierarchical forecasting* in
            the Chronos Documentation.
          required: false
        - in: formData
          name: comment
          type: string
          description: |
            Here you can add a comment to your run.
          required: false
        - in: formData
          name: runOnPowerfulMachines
          type: boolean
          description: |
            With this setting, Chronos will run on a dedicated machine instead
            of the shared cluster. This ensures consistent runtime, but comes
            with additional startup time and creates additional costs - best
            used for productive use cases.
          required: false
        - in: formData
          name: chronosVersion
          type: string
          description: |
            The version of Chronos you want to use. If you do not provide a
            version, the latest version will be used. This is an advanced
            setting that you should only use if a new version of Chronos is not
            compatible with your data. You can find Chronos version in the
            Chronos repository.
          required: false
        - in: formData
          name: backtesting
          type: string
          description: |
            This feature allows running Chronos multiple times to simulate past
            runs on the same data. Set to a positive number `n` to run
            backtesting. Chronos will run your data `n` times, each time
            simulating the past by removing the last `n` time steps from your
            data. This is useful to evaluate the quality of your forecast.

            Learn more about this feature in the Chronos Documentation.

            Please be aware that this effectively multiplies the runtime of
            Chronos by `n`.
          required: false
        - name: "apiKey"
          in: "header"
          description: |
            Authorization header. You can find or generate your API key in the
            Chronos UI Application.

            This key is project-specific and should be used if using the REST
            API directly. Do not specify an Authorization header if using this
            key.
          required: false
          type: "string"
      responses:
        201:
          description: "Returns message of success or failure "
          schema:
            $ref: "#/definitions/ForecastRunResponseVO"
        400:
          description: "Bad Request"
          schema:
            $ref: "#/definitions/GenericMessage"
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
  
  #
  #  supported http methods DELETE
  #
  # path example ../forecasts/{id}/runs/{correlationid}
  
  /forecasts/{id}/runs/{correlationid}:
    get:
      tags:
        - "forecast-runs"
      summary: "Get visualization data for specific run."
      description:  "Get visualization data for specific run."
      operationId: "getRunVisualizationData"
      parameters:
        - in: "path"
          name: "id"
          description: "forecast project ID "
          required: true
          type: "string"
        - in: "path"
          name: "correlationid"
          description: "DNA correlation Id for the run"
          required: true
          type: "string"
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      responses:
        201:
          description: "Returns message of success or failure"
          schema:
            $ref: "#/definitions/RunVisualizationVO"
        204:
          description: "Fetch complete, no content found."
        400:
          description: "Bad request."
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"


  /forecasts/{id}/runs/{correlationid}/results:
    get:
      tags:
        - "forecast-runs"
      summary: "Get file for specific run."
      description: "Get file for specific run."
      operationId: "getRunResultsFile"
      parameters:
        - in: path
          name: id
          description: "forecast project ID "
          required: true
          type: string
        - in: path
          name: correlationid
          description: "DNA correlation Id for the run"
          required: true
          type: string
        - in: query
          name: file
          description: "file which the user requests. Examples:- eda.json, visuals/results.html"
          required: true
          type: string
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      responses:
        201:
          description: "Returns message of success or failure"
          schema:
            $ref: "#/definitions/ByteArrayResource"
        204:
          description: "Fetch complete, no content found."
        400:
          description: "Bad request."
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"

    delete:
      tags:
        - "forecast-runs"
      summary: "delete particular run"
      description: "delete particular run based on id"
      operationId: "deleteRun"
      parameters:
        - in: "path"
          name: "id"
          description: "forecast project ID "
          required: true
          type: "string"
        - in: "path"
          name: "correlationid"
          description: "DNA correlation Id for the run"
          required: true
          type: "string"
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      responses:
        201:
          description: "Returns message of success or failure"
          schema:
            $ref: "#/definitions/GenericMessage"
        204:
          description: "Fetch complete, no content found."
        400:
          description: "Bad request."
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"

    put:
      tags:
        - "forecast-runs"
      summary: "Cancel particular run based on id."
      description: "Cancel particular run based on id."
      operationId: "cancelRun"
      parameters:
        - name: "id"
          in: "path"
          description: "forecast project ID to be updated"
          required: true
          type: "string"
        - in: "path"
          name: "correlationid"
          description: "DNA correlation Id for the run"
          required: true
          type: "string"
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      responses:
        200:
          description: "Returns message of success or failure"
          schema:
            $ref: "#/definitions/CancelRunResponseVO"
        204:
          description: "Fetch complete, no content found."
        400:
          description: "Bad request."
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"

#forecst-runs-comparisons
  /forecasts/{id}/comparisons:
    post:
      tags:
        - "forecast-comparisons"
      summary: "Create new comparison for forecast project."
      description: "Create comparison for forecast project"
      operationId: "createForecastComparison"
      consumes:
        - multipart/form-data
      parameters:
        - in: "path"
          name: "id"
          description: "forecast project ID "
          required: true
          type: "string"
        - in: formData
          name: actualsFile
          type: file
          description: The actuals file for the comparison of forecast runs.
        - in: formData
          name: businessFile
          type: file
          description: The business file for the comparison of forecast runs.
        - in: formData
          name: "comparisonName"
          type: "string"
          description: "Run Comparison name"
        - in: formData
          name: "runCorelationIds"
          description: "Comma separated forecast run corelation Ids. Maximum 12 Ids can be sent. Please avoid sending duplicates."
          required: true
          type: "string"
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      responses:
        201:
          description: "Returns message of success or failure "
          schema:
            $ref: "#/definitions/ForecastComparisonCreateResponseVO"
        400:
          description: "Bad Request"
          schema:
            $ref: "#/definitions/GenericMessage"
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
    
    get:
      tags:
        - "forecast-comparisons"
      summary: "Get all forecast comparison runs for the project"
      description: "Get all forecast comparison runs for the project"
      operationId: "getForecastComparisons"
      parameters:
        - in: "path"
          name: "id"
          description: "forecast project ID "
          required: true
          type: "string"
        - in: "query"
          name: "offset"
          description: "forecast comparisons page number "
          required: false
          type: integer
        - in: "query"
          name: "limit"
          description: "forecast comparisons page size"
          required: false
          type: integer
        - name: sortBy
          in: query
          description: Sort comparisons by a given variable like comparisonName, createdby, createdon or status
          required: false
          type: string
          enum: [ comparisonName,createdOn,status,createdBy,actualsFile,businessFile ]
        - name: sortOrder
          in: query
          description: Sort comparisons based on the given order, example asc,desc
          required: false
          type: string
          enum: [ asc,desc ]
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      responses:
        201:
          description: "Returns message of success or failure"
          schema:
            $ref: "#/definitions/ForecastComparisonsCollectionDto"
        204:
          description: "Fetch complete, no content found."
        400:
          description: "Bad request."
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
    
    delete:
      tags:
        - "forecast-comparisons"
      summary: "delete one or more comparisons"
      description: "delete one or more comparisons"
      operationId: "deleteComparison"
      parameters:
        - in: "path"
          name: "id"
          description: "forecast project ID "
          required: true
          type: "string"
        - in: "query"
          name: "comparisonIds"
          description: "Comma separated forecast comparison IDs that are to be deleted. Ex: ?comparisonIds=\"ComparisionX01,ComparisionX02\" "
          required: true
          type: "string"
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      responses:
        201:
          description: "Returns message of success or failure"
          schema:
            $ref: "#/definitions/GenericMessage"
        204:
          description: "Fetch complete, no content found."
        400:
          description: "Bad request."
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"

  # path example ../forecasts/{id}/comparisons/{comparisonId}/comparisonData
  /forecasts/{id}/comparisons/{comparisonId}/comparisonData:
    get:
      tags:
        - "forecast-comparisons"
      summary: "Get forecast comparison html for specific comparison."
      description: "Get forecast comparison html for specific comparison."
      operationId: "getForecastComparisonById"
      parameters:
        - in: "path"
          name: "id"
          description: "forecast project ID "
          required: true
          type: "string"
        - in: "path"
          name: "comparisonId"
          description: "Comparison Id for the run"
          required: true
          type: "string"
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      responses:
        201:
          description: "Returns message of success or failure"
          schema:
            $ref: "#/definitions/ForecastComparisonResultVO"
        204:
          description: "Fetch complete, no content found."
        400:
          description: "Bad request."
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
  
  #forecst-project-config-files
  /forecasts/{id}/config-files:
    post:
      tags:
        - "forecast-config-files"
      summary: "Upload a new config file for forecast project."
      description: "Upload a new config file for forecast project"
      operationId: "uploadConfigFiles"
      consumes:
        - multipart/form-data
      parameters:
        - in: "path"
          name: "id"
          description: "forecast project ID "
          required: true
          type: "string"
        - in: formData
          name: configFile
          type: file
          description: The config file to upload for the forecast project.
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      responses:
        201:
          description: "Returns message of success or failure "
          schema:
            $ref: "#/definitions/ForecastConfigFileUploadResponseVO"
        400:
          description: "Bad Request"
          schema:
            $ref: "#/definitions/GenericMessage"
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
    
    get:
      tags:
        - "forecast-config-files"
      summary: "Get all uploaded config files for the project"
      description: "Get all uploaded config files for the project"
      operationId: "getForecastConfigFiles"
      parameters:
        - in: "path"
          name: "id"
          description: "forecast project ID "
          required: true
          type: "string"
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      responses:
        201:
          description: "Returns message of success or failure"
          schema:
            $ref: "#/definitions/ForecastConfigFilesCollectionDto"
        204:
          description: "Fetch complete, no content found."
        400:
          description: "Bad request."
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
          
  # path example ../forecasts/{id}/config-files/{configFileId
  /forecasts/{id}/config-files/{configFileId}:
    delete:
      tags:
        - "forecast-config-files"
      summary: "delete uploaded config file by id."
      description: "delete uploaded config file by id."
      operationId: "deleteConfigFile"
      parameters:
        - in: "path"
          name: "id"
          description: "forecast project ID "
          required: true
          type: "string"
        - name: "configFileId"
          in: "path"
          description: "config file ID"
          required: true
          type: "string"
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      responses:
        201:
          description: "Returns message of success or failure"
          schema:
            $ref: "#/definitions/GenericMessage"
        204:
          description: "Fetch complete, no content found."
        400:
          description: "Bad request."
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
  
  # path example ../forecasts/{id}/config-files/{configFileId}/configFileData
  /forecasts/{id}/config-files/{configFileId}/configFileData:
    get:
      tags:
        - "forecast-config-files"
      summary: "Get specific forecast config yaml for a forecast project."
      description: "Get specific forecast config yaml for a forecast project."
      operationId: "getForecastConfigFileById"
      parameters:
        - in: "path"
          name: "id"
          description: "forecast project ID "
          required: true
          type: "string"
        - in: "path"
          name: "configFileId"
          description: "Specific config file  Id for the forecast project"
          required: true
          type: "string"
        - name: "apiKey"
          in: "header"
          description: "Authorization header"
          required: false
          type: "string"
      responses:
        201:
          description: "Returns message of success or failure"
          schema:
            $ref: "#/definitions/ForecastConfigFileResultVO"
        204:
          description: "Fetch complete, no content found."
        400:
          description: "Bad request."
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
  
  /forecasts/transparency:
    get:
      tags:
        - "forecast-projects"
      summary: "Number of forecast-projects and users count."
      description: "Get number of forecast-projects and users. This endpoints will be used to get number of counts available in forecast-projects and users."
      operationId: "getNumberOfForecastProjects"
      responses:
        201:
          description: "Returns message of success or failure"
          schema:
            $ref: "#/definitions/TransparencyVO"
        204:
          description: "Fetch complete, no content found."
        400:
          description: "Bad request."
        401:
          description: "Request does not have sufficient credentials."
        403:
          description: "Request is not authorized."
        405:
          description: "Method not allowed"
        500:
          description: "Internal error"
definitions:
  TransparencyVO:
    type: object
    properties:
      projectCount:
        type: integer
        description: "Number of forecast-projects count"
      userCount:
        type: integer
        description: "Number of forecast-projects users count"
  InputFilesCollectionVO:
    type: object
    properties:
      files:
        type: array
        items:
          $ref: "#/definitions/InputFileVO"
  
  InputFileVO:
    type: object
    properties:
      id:
        type: string
        description: id of the file
      name:
        type: string
        description: name of the file
      path:
        type: string
        description: full path of the file object in minio with bucketname
      createdBy:
        type: string
        description: shortid of user who uploaded the file
      createdOn:
        type: string
        format: date
        description: time when file is uploaded
  
  ForecastCollectionVO:
    type: object
    properties:
      totalCount:
        type: integer
        description: "Total Record Count"
      records:
        type: array
        items:
          $ref: "#/definitions/ForecastVO"
  
  ForecastProjectCreateRequestWrapperVO:
    type: object
    properties:
      data:
        $ref: "#/definitions/ForecastProjectCreateRequestVO"
  
  ForecastProjectCreateRequestVO:
    type: object
    properties:
      name:
        type: string
        description: name of the forecast project.
      permission:
        $ref: "#/definitions/ForecastPermissionVO"
      collaborators:
        type: array
        items:
          $ref: "#/definitions/CollaboratorVO"
      leanGovernanceFeilds:
        $ref: "#/definitions/LeanGovernanceFeildVO"
        description: lean governance details
      # required:
# TEMP        - name
  
  ForecastProjectUpdateRequestVO:
    type: object
    properties:
      addCollaborators:
        type: array
        items:
          $ref: "#/definitions/CollaboratorVO"
          description: "To add collaborators"
      removeCollaborators:
        type: array
        items:
          $ref: "#/definitions/CollaboratorVO"
          description: "To remove collaborators"
      apiKey:
        type: string
        description: apiKey for the project access
      leanGovernanceFeilds:
        $ref: "#/definitions/LeanGovernanceFeildVO"
        description: lean governance details
  
  ForecastPermissionVO:
    type: object
    properties:
      read:
        type: boolean
      write:
        type: boolean
  
  CollaboratorVO:
    type: object
    properties:
      id:
        type: string
        description: "Short id of the user"
      permissions:
        $ref: "#/definitions/ForecastPermissionVO"
        description: "Read write permissions"
      firstName:
        type: string
        description: "First Name of the user"
      lastName:
        type: string
        description: "Last Name of the user"
      department:
        type: string
        description: "Department of the user"
      email:
        type: string
        description: "E-Mail of the user"
        format: email
      mobileNumber:
        type: string
        description: "Mobile number of the user"
      
      # required:
      #   - id
      #   - firstName
      #   - lastName
      #   - department
      #   - email
  
  ApiKeyResponseVO:
    type: object
    properties:
      data:
        $ref: "#/definitions/ApiKeyVO"
      response:
        $ref: "#/definitions/GenericMessage"
  
  ApiKeyVO:
    type: object
    properties:
      apiKey:
        type: string
        description: Api key for the forecast project.
  
  ForecastProjectResponseVO:
    type: object
    properties:
      data:
        $ref: "#/definitions/ForecastVO"
      response:
        $ref: "#/definitions/GenericMessage"
  
  ForecastVO:
    type: object
    properties:
      id:
        type: string
        description: id of the forecast project
      name:
        type: string
        description: name of the forecast project
      bucketName:
        type: string
        description: returns the name of storage bucket where forecast artifacts are stored
      bucketId:
        type: string
        description: returns the id of the storage bucket.
      permission:
        $ref: "#/definitions/ForecastPermissionVO"
      collaborators:
        type: array
        items:
          $ref: "#/definitions/CollaboratorVO"
      createdBy:
        $ref: "#/definitions/CreatedByVO"
        description: createdBy user details
      createdOn:
        type: string
        format: date
        description: date when project created
      savedInputs:
        type: array
        items:
          $ref: "#/definitions/InputFileVO"
      runs:
        type: array
        items:
          $ref: "#/definitions/RunVO"
      comparisons:
        type: array
        items:
          $ref: "#/definitions/ForecastComparisonVO"
      configFiles:
        type: array
        items:
          $ref: "#/definitions/InputFileVO"
      leanGovernanceFeilds:
        $ref: "#/definitions/LeanGovernanceFeildVO"
        description: lean governance details
  
  LeanGovernanceFeildVO:
    type: object
    properties:
      typeOfProject:
        type: string
        description: type of forecast
      decription:
        type: string
        description: decription of forecast
      divisionId:
        type: string
        description: divisionId of forecast
      division:
        type: string
        description: division of forecast
      subDivisionId:
        type: string
        description: subDivisionId of forecast
      subDivision:
        type: string
        description: subDivision of forecast
      department:
        type: string
        description: department of forecast
      tags:
        type: array
        items:
          type: string
        description: tags of forecast
      dataClassification:
        type: string
        description: dataClassification of forecast
      piiData:
        type: boolean
        description: pii of forecast
      archerId:
        type: string
        description: archerId of forecast
      procedureId:
        type: string
        description: producerId of forecast
      termsOfUse:
        type: boolean
        description: termsAndUse of forecast
      # required:
        # -description
        # -division
        # -subDivision
        # -department
        # -typeOfProject
        # -dataClassfication
        # -piiData
        # -termsOfUse
  
  ForecastRunRequestVO:
    type: object
    properties:
      savedInputPath:
        type: string
        description: path of file in minio system, if not giving file in request part
      saveRequestPart:
        type: boolean
        description: flag whether to save file in request part to storage bucket for further runs
      runName:
        type: string
        description: name of the run sample. Example YYYY-MM-DD_run_topic
      configurationFile:
        type: string
        enum: [Default-Settings]
        description: "Chronos default config yml"
      frequency:
        type: string
        enum: [Daily,Weekly,Monthly,Yearly,No_Frequency]
        description: "frequency parameter."
      forecastHorizon:
        type: number
        minimum: 1
        description: "Any number greater than 1"
      hierarchy:
        type: string
        description: "Levels Of Hierarchy number between 2 to 20 Or null"
      comment:
        type: string
        description: "Comments for the run"
      infotext:
        type: string
        description: "Text field to denote Chronos Version"
      runOnPowerfulMachines:
        type: boolean
        description: "If true, then run on Powerful Machines"
        default: false
      # required:
        # -inputfile
        # -configurationFile
        # -frequency
        # -forecastHorizon
  
  
  DataBricksErrorResponseVO:
    type: object
    properties:
      error_code:
        type: string
        description: error code if fails
      message:
        type: string
        description: error message if fails
  
  RunNowResponseVO:
    type: object
    properties:
      correlation_id:
        type: string
        description: correlation id generated at DNA System
      run_id:
        type: string
        description: Databricks generated run id
      number_in_job:
        type: string
        description: number in the job
      resultFolderPath:
        type: string
        description: "result folder path"
      error_code:
        type: string
        description: error code if fails
      message:
        type: string
        description: error message if fails
  
  RunStateVO:
    type: object
    properties:
      life_cycle_state:
        type: string
        enum: [PENDING,RUNNING,TERMINATING,TERMINATED,INTERNAL_ERROR,SKIPPED]
      result_state:
        type: string
        enum: [SUCCESS,FAILED,TIMEDOUT,CANCELED,WARNINGS]
      state_message:
        type: string
      user_cancelled_or_timedout:
        type: boolean
  
  RunUpdateRequestWrapperVO:
    type: object
    properties:
      data:
        $ref: "#/definitions/RunUpdateRequestVO"
  
  RunUpdateRequestVO:
    type: object
    properties:
      state:
        type: string
        enum: [SUCCESS,FAILED]
      stateMessage:
        type: string
        description: "Message of state, details of run status"
  
  RunDetailsVO:
    type: object
    properties:
      job_id:
        type: string
      run_id:
        type: string
      creator_user_name:
        type: string
      state:
        $ref: "#/definitions/RunStateVO"
      warnings:
        type: string
      error:
        type: string
      tasks:
        type: array
        items:
          $ref: "#/definitions/RunTaskVO"
      startTime:
        type: number
        format: int64
      endTime:
        type: number
        format: int64
      setupDuration:
        type: number
        format: int64
      executionDuration:
        type: number
        format: int64
      cleanup_duration:
        type: number
        format: int64
  
  
  RunTaskVO:
    type: object
    properties:
      run_id:
        type: string
      state:
        $ref: "#/definitions/RunStateVO"
  
  JobRunsListVO:
    type: object
    properties:
      runs:
        type: array
        items:
          $ref: "#/definitions/RunDetailsVO"
  
  RunVO:
    type: object
    properties:
      id:
        type: string
        description: unique id for the run, used as correlation id
      jobId:
        type: string
        description: Test
      runId:
        type: string
        description: Test
      inputFile:
        type: string
        description: path of file in minio system
      runName:
        type: string
        description: name of the run sample. Example YYYY-MM-DD_run_topic
      configurationFile:
        type: string
        enum: [Default-Settings]
        description: "Chronos default config yml"
      frequency:
        type: string
        enum: [Daily,Weekly,Monthly,Yearly,No_Frequency]
        description: "frequency parameter."
      forecastHorizon:
        type: string
        minimum: 1
        description: "Any number greater than 1"
      hierarchy:
        type: string
        description: "Levels Of Hierarchy number between 2 to 20 Or null"
      comment:
        type: string
        description: "Comments for the run"
      runOnPowerfulMachines:
        type: boolean
        description: "If true, then run on Powerful Machines"
        default: false
      state:
        $ref: "#/definitions/RunStateVO"
      triggeredBy:
        type: string
        description: "Short Id of user who triggered the run"
      triggeredOn:
        type: string
        format: date
      creatorUserName:
        type: string
        description: "user who created the run in databricks system"
      startTime:
        type: string
        description: "time when run started"
      endTime:
        type: string
        description: "time when run ended"
      setupDuration:
        type: string
        description: "time taken for setup"
      executionDuration:
        type: string
        description: "time taken to execute"
      resultFolderPath:
        type: string
        description: "result folder path"
      warnings:
        type: string
        description: "warnings"
      warningsInfo:
        type: string
        description: "warnings info text"
      error:
        type: string
        description: "error"
      exogenData:
        type: boolean
        description: "flag to check if exogenous data is present"
      chronosVersion:
        type: string
        description: "Text field to denote Chronos Version"
      backtesting:
        type: string
        description: "Text field to denote Chronos Backtesting"
      isDeleted:
        type: boolean
        description: "Field to identify if run is deleted. Deleted run records wont be shown, this is only for system to identify. Not for Users."
  
  ForecastRunResponseVO:
    type: object
    properties:
      data:
        $ref: "#/definitions/RunNowResponseVO"
      response:
        $ref: "#/definitions/GenericMessage"
  
  ForecastRunCollectionVO:
    type: object
    properties:
      totalCount:
        type: integer
        description: "Total Record Count"
      records:
        type: array
        items:
          $ref: "#/definitions/RunVO"
  
  ForecastComparisonsCollectionDto:
    type: object
    properties:
      totalCount:
        type: integer
        description: "Total Record Count"
      records:
        type: array
        items:
          $ref: "#/definitions/ForecastComparisonVO"
  
  
  
  ForecastComparisonCreateResponseVO:
    type: object
    properties:
      data:
        $ref: "#/definitions/ForecastComparisonVO"
      response:
        $ref: "#/definitions/GenericMessage"
  
  
  ForecastComparisonVO:
    type: object
    properties:
      comparisonId:
        type: string
        description: "comparison run id for the forecast project"
      comparisonName:
        type: string
        description: "comparison run name"
      triggeredBy:
        type: string
        description: "Short Id of user who triggered the comparison"
      triggeredOn:
        type: string
        format: date
        description: "Date/Time for the triggered comparison"
      actualsFile:
        type: string
        description: "actuals file for the comparison of forecast runs"
      businessFile:
        type: string
        description: "business file for the comparison of forecast runs"
      targetFolder:
        type: string
        description: "target folder to add comparison.html"
      runsList:
        type: array
        "items":
          "type": string
      isDeleted:
        type: boolean
        description: "Field to identify if comparison is deleted. Deleted comparison records wont be shown, this is only for system to identify. Not for Users."
      state:
        $ref: "#/definitions/ComparisonStateVO"
  
  ComparisonStateVO:
    type: object
    properties:
      lifeCycleState:
        type: string
        enum: [ CREATED,RUNNING,FAILED,SUCCESS]
      stateMessage:
        type: string
  
  ForecastComparisonResultVO:
    type: object
    properties:
      comparisonName:
        type: string
      comparisonData:
        type: string
      response:
        $ref: "#/definitions/GenericMessage"
  
  ForecastConfigFileUploadResponseVO:
    type: object
    properties:
      data:
        $ref: "#/definitions/InputFileVO"
      response:
        $ref: "#/definitions/GenericMessage"
  
  ForecastConfigFilesCollectionDto:
    type: object
    properties:
      totalCount:
        type: integer
        description: "Total Record Count"
      records:
        type: array
        items:
          $ref: "#/definitions/InputFileVO"
  
  ForecastConfigFileResultVO:
    type: object
    properties:
      configFileId:
        type: string
      configFileName:
        type: string
      configFileData:
        type: string
      response:
        $ref: "#/definitions/GenericMessage"

  CancelRunResponseVO:
    type: object
    properties:
      data:
        $ref: "#/definitions/RunVO"
      response:
        $ref: "#/definitions/GenericMessage"

  BindingResult:
    type: object
  
  GenericMessage:
    type: object
    properties:
      success:
        type: string
      errors:
        type: array
        items:
          $ref: "#/definitions/MessageDescription"
      warnings:
        type: array
        items:
          $ref: "#/definitions/MessageDescription"
  
  MessageDescription:
    type: object
    properties:
      message:
        type: string
        description: "message"
  
  CreatedByVO:
    type: object
    properties:
      id:
        type: string
        description: "ID of user"
      firstName:
        type: string
        description: "First Name of the user"
      lastName:
        type: string
        description: "Last Name of the user"
      department:
        type: string
        description: "Department of the user"
      email:
        type: string
        description: "E-Mail of the user"
      mobileNumber:
        type: string
        description: "Mobile number of the user"
  
  RunVisualizationVO:
    type: object
    properties:
      id:
        type: string
      runId:
        type: string
      runName:
        type: string
      frequency:
        type: string
      forecastHorizon:
        type: string
      hierarchy:
        type: string
      #y:
      #  type: string
      #yPred:
      #  type: string
      #eda:
      #  type: string
      visualsData:
        type: string
      response:
        $ref: "#/definitions/GenericMessage"
 
 
